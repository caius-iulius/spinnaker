use Core

def pub sequence : forall m a. {Monad m} => List (m a) -> m (List a)
    = \lm -> put lm
    | Nil -> return Nil
    | Cons m ms -> m >>= \a -> sequence ms >>= \as -> return (a :: as)

rel pub {Monad m} => MonadPlus m =
    # LAWS
    # 1) MONOID
    # 1.1) mplus mzero a = a
    # 1.2) mplus a mzero = a
    # 1.3) mplus (mplus a b) c = mplus a (mplus b c)
    # 2) mzero >>= f = mzero
    # 3) m >> mzero = mzero
    mzero : forall a. m a,
    mplus : forall a. m a -> m a -> m a

def pub guard : forall m. {MonadPlus m} => Bool -> m ()
    = \b -> put b
    | True -> return ()
    | False -> mzero

inst MonadPlus List {
    def mzero = Nil
    def mplus = (++)
}

rel pub {Monad m} => MonadFail m =
    # Se {MonadPlus m} si puÃ² considerare: mzero = fail "mzero"
    fail : forall a. List Chr -> m a

inst MonadFail IO {
    def fail = error
}
