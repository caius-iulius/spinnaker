use Std
use Maybe use List

def sieve = \n -> let sieve_iter
        = \l -> put l
        | [] -> None
        | [x | xs] -> Some (x, xs \\ map (x*) $ take (1+ length xs / x) l)
    -> unfoldr sieve_iter (2..=n)

def main = sieve 100
